<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Integrate Signature Genes Across Datasets — Intsg • CAESAR.Suite</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Integrate Signature Genes Across Datasets — Intsg"><meta property="og:description" content="This function integrates signature genes across different datasets by identifying common genes that meet specific criteria. It filters out mitochondrial and ribosomal genes, allows for the exclusion of genes based on expression proportion, and supports weighting gene selection by cell type ratios."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CAESAR.Suite</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/STMOB.html">ST MOB data analysis</a>
    </li>
    <li>
      <a href="../articles/XeniumBC.html">Xenium BC data analysis</a>
    </li>
    <li>
      <a href="../articles/XeniumBCEIF.html">Xenium BC extract image features</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/XiaoZhangryy/CAESAR.Suite/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Integrate Signature Genes Across Datasets</h1>
    <small class="dont-index">Source: <a href="https://github.com/XiaoZhangryy/CAESAR.Suite/blob/HEAD/R/caesar_plot.r" class="external-link"><code>R/caesar_plot.r</code></a></small>
    <div class="hidden name"><code>Intsg.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function integrates signature genes across different datasets by identifying common genes that meet specific criteria. It filters out mitochondrial and ribosomal genes, allows for the exclusion of genes based on expression proportion, and supports weighting gene selection by cell type ratios.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Intsg</span><span class="op">(</span></span>
<span>  <span class="va">sg_List</span>,</span>
<span>  <span class="va">ntop</span>,</span>
<span>  ct_ratio <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  expr.prop.cutoff <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"hm"</span>,</span>
<span>  rm_mito_ribo <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ratio_lower_bound <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>sg_List</dt>
<dd><p>A list of signature gene lists for different datasets. Each element in the list should be a named list where the names correspond to cell types, and each cell type contains a data frame with gene information.</p></dd>


<dt>ntop</dt>
<dd><p>An integer specifying the maximum number of top genes to retain for each cell type.</p></dd>


<dt>ct_ratio</dt>
<dd><p>A list of numeric vectors specifying the ratio of cells for each cell type in the datasets. If <code>NULL</code>, no weighting is applied. Default is <code>NULL</code>.</p></dd>


<dt>expr.prop.cutoff</dt>
<dd><p>A numeric value specifying the minimum expression proportion required for a gene to be considered. Default is 0.1.</p></dd>


<dt>species</dt>
<dd><p>A character string specifying the species, either "hm" (human) or "ms" (mouse). Default is "hm".</p></dd>


<dt>rm_mito_ribo</dt>
<dd><p>Logical, indicating whether to remove mitochondrial and ribosomal genes from the signature gene list. Default is <code>TRUE</code>.</p></dd>


<dt>ratio_lower_bound</dt>
<dd><p>A numeric value specifying the lower bound for the cell type ratio. Only cell types with a ratio above this bound are considered. Default is 0.0.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A named list where each element corresponds to a cell type and contains the integrated list of top signature genes.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">toydata</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">seu</span> <span class="op">&lt;-</span> <span class="va">toydata</span><span class="op">$</span><span class="va">seu</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">seu</span> <span class="op">&lt;-</span> <span class="fu">ProFAST</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProFAST/man/pdistance.html" class="external-link">pdistance</a></span><span class="op">(</span><span class="va">seu</span>, reduction <span class="op">=</span> <span class="st">"caesar"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculate co-embedding distance...</span>
<span class="r-in"><span><span class="va">sglist</span> <span class="op">&lt;-</span> <span class="fu"><a href="find.sig.genes.html">find.sig.genes</a></span><span class="op">(</span>seu <span class="op">=</span> <span class="va">seu</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">top2sgs</span> <span class="op">&lt;-</span> <span class="fu">Intsg</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">sglist</span><span class="op">)</span>, ntop <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">top2sgs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $CAFs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "FBLN1"  "CCDC80"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Cancer Epithelial`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "LYPD3" "MLPH" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Endothelial</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "HOXD9" "EGFL7"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Myeloid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "HAVCR2" "IGSF6" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Normal Epithelial`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "KRT5"  "KRT6B"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $PVL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "CAV1"   "AVPR1A"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Plasmablasts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "CD79A" "DERL3"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`T-cells`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "CD3G" "CD3D"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">top2intsgs</span> <span class="op">&lt;-</span> <span class="fu">Intsg</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">sglist</span>, <span class="va">sglist</span><span class="op">)</span>, ntop <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Xiao Zhang, Wei Liu, Jin Liu.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

