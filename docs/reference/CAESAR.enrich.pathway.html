<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Test whether pathways are enriched — CAESAR.enrich.pathway • CAESAR.Suite</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Test whether pathways are enriched — CAESAR.enrich.pathway"><meta property="og:description" content="This function tests whether pathways are enriched. Specifically, for a pathway (gene set), the function will assess whether these genes are clustered in the embedding space. For more details, see Bai and Chu (2023)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CAESAR.Suite</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/STMOB.html">ST MOB data analysis</a>
    </li>
    <li>
      <a href="../articles/XeniumBC.html">Xenium BC data analysis</a>
    </li>
    <li>
      <a href="../articles/XeniumBCEIF.html">Xenium BC extract image features</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/XiaoZhangryy/CAESAR.Suite/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Test whether pathways are enriched</h1>
    <small class="dont-index">Source: <a href="https://github.com/XiaoZhangryy/CAESAR.Suite/blob/HEAD/R/CAESAR_enrich_pathway.R" class="external-link"><code>R/CAESAR_enrich_pathway.R</code></a></small>
    <div class="hidden name"><code>CAESAR.enrich.pathway.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function tests whether pathways are enriched. Specifically, for a pathway (gene set), the function will assess whether these genes are clustered in the embedding space. For more details, see Bai and Chu (2023).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">CAESAR.enrich.pathway</span><span class="op">(</span></span>
<span>  <span class="va">seu</span>,</span>
<span>  <span class="va">pathway.list</span>,</span>
<span>  reduction <span class="op">=</span> <span class="st">"caesar"</span>,</span>
<span>  pathway.cutoff <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  test.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"ori"</span>, <span class="st">"gen"</span>, <span class="st">"wei"</span>, <span class="st">"max"</span><span class="op">)</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  wei.fun <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"weiMax"</span>, <span class="st">"weiGeo"</span>, <span class="st">"weiArith"</span><span class="op">)</span>,</span>
<span>  perm.num <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  progress_bar <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  eta <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  genes.use <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>seu</dt>
<dd><p>A Seurat object containing co-embedding.</p></dd>


<dt>pathway.list</dt>
<dd><p>A list of pathways, where each pathway is characterized as a vector of gene sets.</p></dd>


<dt>reduction</dt>
<dd><p>The embedding used when a Seurat object is provided. Default is "caesar".</p></dd>


<dt>pathway.cutoff</dt>
<dd><p>The minimal number of genes required in a pathway. Pathways with fewer genes than this threshold will not be considered in the enrichment test.</p></dd>


<dt>test.type</dt>
<dd><p>Type of graph-based test. This must be a list containing elements chosen from "ori", "gen", "wei", and "max", with default `list("ori", "gen", "wei", "max")`. "ori" refers to robust original edge-count test, "gen" refers to robust generalized edge-count test, "wei" refers to robust weighted edge-count test, and "max" refers to robust max-type edge-count tests. For more details, see Bai and Chu (2023).</p></dd>


<dt>k</dt>
<dd><p>The parameter for k-minimum spanning tree. Default is 5.</p></dd>


<dt>wei.fun</dt>
<dd><p>The weighted function used in the enrichment test. Default is "weiMax", which returns the inverse of the max node degree of an edge. "weiGeo" returns the inverse of the geometric average of the node degrees, and "weiArith" returns the inverse of the arithmetic average of the node degrees.</p></dd>


<dt>perm.num</dt>
<dd><p>The number of permutations used to calculate the p-value (default is 0). Use 0 for getting only the approximate p-value based on asymptotic theory. Setting perm.num (e.g., perm.num = 1000) allows permutation-based p-value calculation, though this may be time-consuming.</p></dd>


<dt>progress_bar</dt>
<dd><p>Logical, TRUE or FALSE, indicating whether a progress bar should be printed during permutations. Default is TRUE.</p></dd>


<dt>ncores</dt>
<dd><p>The number of cores to use for parallel computing. Default is 10.</p></dd>


<dt>eta</dt>
<dd><p>A small positive number to ensure matrix inversion stability. Default is 1e-4.</p></dd>


<dt>genes.use</dt>
<dd><p>A vector of genes representing a gene set. All pathways will be tested for enrichment after intersecting with this gene set.</p></dd>


<dt>parallel</dt>
<dd><p>Logical, indicating whether to use parallel computing to speed up computation. Default is TRUE.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A data.frame containing the results of the test with the following columns:</p><ul><li><p>asy.ori.statistic - test statistic of robust original edge-count test.</p></li>
<li><p>asy.ori.pval - asymptotic theory based p value of robust original edge-count test.</p></li>
<li><p>asy.ori.pval.adj - the adjusted asymptotic theory based p value of robust original edge-count test.</p></li>
<li><p>perm.ori.pval - permutation-based p value of robust original edge-count test, appear when permutation-based p-value is calculated.</p></li>
<li><p>perm.ori.pval.adj - the adjusted permutation-based p value of robust original edge-count test, appear when permutation-based p-value is calculated.</p></li>
<li><p>asy.gen.statistic - test statistic of robust generalized edge-count test.</p></li>
<li><p>asy.gen.pval - asymptotic theory based p value of robust generalized edge-count test.</p></li>
<li><p>asy.gen.pval.adj - the adjusted asymptotic theory based p value of robust generalized edge-count test.</p></li>
<li><p>perm.gen.pval - permutation-based p value of robust generalized edge-count test, appear when permutation-based p-value is calculated.</p></li>
<li><p>perm.gen.pval.adj - the adjusted permutation-based p value of robust generalized edge-count test, appear when permutation-based p-value is calculated.</p></li>
<li><p>asy.wei.statistic - test statistic of robust weighted edge-count test.</p></li>
<li><p>asy.wei.pval - asymptotic theory based p value of robust weighted edge-count test.</p></li>
<li><p>asy.wei.pval.adj - the adjusted asymptotic theory based p value of robust weighted edge-count test.</p></li>
<li><p>perm.wei.pval - permutation-based p value of robust weighted edge-count test, appear when permutation-based p-value is calculated.</p></li>
<li><p>perm.wei.pval.adj - the adjusted permutation-based p value of robust weighted edge-count test, appear when permutation-based p-value is calculated.</p></li>
<li><p>asy.max.statistic - test statistic of robust max-type edge-count tests.</p></li>
<li><p>asy.max.pval - asymptotic theory based p value of robust max-type edge-count tests.</p></li>
<li><p>asy.max.pval.adj - the adjusted asymptotic theory based p value of robust max-type edge-count tests.</p></li>
<li><p>perm.max.pval - permutation-based p value of robust max-type edge-count tests, appear when permutation-based p-value is calculated.</p></li>
<li><p>perm.max.pval.adj - the adjusted permutation-based p value of robust max-type edge-count tests, appear when permutation-based p-value is calculated.</p></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p>Bai, Y., &amp; Chu, L. (2023). A Robust Framework for Graph-based Two-Sample Tests Using Weights. arXiv preprint arXiv:2307.12325.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">toydata</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">seu</span> <span class="op">&lt;-</span> <span class="va">toydata</span><span class="op">$</span><span class="va">seu</span></span></span>
<span class="r-in"><span><span class="va">pathway_list</span> <span class="op">&lt;-</span> <span class="va">toydata</span><span class="op">$</span><span class="va">pathway_list</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">CAESAR.enrich.pathway</span><span class="op">(</span><span class="va">seu</span>, <span class="va">pathway_list</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Only the approximate p-values based on asymptotic theory are calculated as perm.num is set as 0.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              asy.ori.statistic asy.ori.pval asy.gen.statistic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GOBP_VASCULATURE_DEVELOPMENT         -1.854919   0.03180388          23.06323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GOBP_T_CELL_ACTIVATION               -1.235158   0.10838588          38.48264</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              asy.gen.pval asy.wei.statistic asy.wei.pval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GOBP_VASCULATURE_DEVELOPMENT 9.814855e-06          4.669963 1.506273e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GOBP_T_CELL_ACTIVATION       4.401508e-09          5.333820 4.808396e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              asy.max.statistic asy.max.pval gene.set.length</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GOBP_VASCULATURE_DEVELOPMENT          4.669963 4.518814e-06              37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GOBP_T_CELL_ACTIVATION                5.333820 1.442519e-07              48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              asy.ori.pval.adj asy.gen.pval.adj asy.wei.pval.adj</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GOBP_VASCULATURE_DEVELOPMENT       0.06360776     9.814855e-06     1.506273e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GOBP_T_CELL_ACTIVATION             0.10838588     8.803015e-09     9.616793e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              asy.max.pval.adj</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GOBP_VASCULATURE_DEVELOPMENT     4.518814e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GOBP_T_CELL_ACTIVATION           2.885038e-07</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Xiao Zhang, Wei Liu, Jin Liu.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

